/**
 * MIDDLEWARE - CURRENTLY DISABLED
 * 
 * This file has been temporarily disabled and backed up here.
 * 
 * WHY DISABLED:
 * - Authentication is currently handled client-side via AuthContext (src/contexts/AuthContext.tsx)
 * - The dashboard layout (src/app/(dashboard)/layout.tsx) handles auth guards and redirects
 * - No server-side authentication/session management is in place yet
 * - This middleware was causing module resolution errors in Next.js
 * 
 * WHEN TO RE-ENABLE:
 * When integrating Keycloak (or another IDP), this middleware will be needed to:
 * 1. Validate JWT tokens from Keycloak
 * 2. Check session validity on the server side
 * 3. Enforce role-based access control (RBAC)
 * 4. Handle token refresh flows
 * 5. Protect API routes
 * 
 * KEYCLOAK INTEGRATION TODO:
 * - Install: next-auth (for OAuth/OIDC) or keycloak-js
 * - Configure Keycloak realm, client, and roles
 * - Update this middleware to validate Keycloak tokens
 * - Move middleware to root directory: middleware.ts (not src/middleware.ts)
 * - Replace client-side auth with server-side session management
 * 
 * REFERENCE IMPLEMENTATION:
 */

import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;
  
  // Public paths that don't require authentication
  const publicPaths = ['/login'];
  const isPublicPath = publicPaths.some(path => pathname.startsWith(path));
  
  // TODO: For Keycloak integration, add:
  // 1. Extract JWT token from cookies or Authorization header
  // const token = request.cookies.get('keycloak-token')?.value;
  
  // 2. Verify token with Keycloak
  // const isValid = await verifyKeycloakToken(token);
  
  // 3. Check user roles and permissions
  // const userRoles = await getUserRolesFromToken(token);
  
  // 4. Implement redirect logic
  // if (!token && !isPublicPath) {
  //   return NextResponse.redirect(new URL('/login', request.url));
  // }
  
  return NextResponse.next();
}

// Configure which routes the middleware should run on
export const config = {
  matcher: [
    /*
     * Match all request paths except for the ones starting with:
     * - api (API routes)
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * - public files (svg, png, jpg)
     */
    '/((?!api|_next/static|_next/image|favicon.ico|.*\\.svg|.*\\.png|.*\\.jpg).*)',
  ],
};

